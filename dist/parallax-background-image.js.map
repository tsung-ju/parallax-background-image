{
  "version": 3,
  "sources": ["../src/parallax-viewport.js", "../src/transform.js", "../src/parallax-element.js", "../src/main.js"],
  "sourcesContent": ["const template = document.createElement(\"template\");\ntemplate.innerHTML = `\n  <style>\n    :host {\n      display: block;\n      overflow: auto;\n      -webkit-overflow-scrolling: touch;\n    }\n    :host([hidden]) {\n      display: none;\n    }\n    :host([backend=\"3d\"]) {\n      perspective: 1px;\n      perspective-origin: 0 0;\n    }\n  </style>\n  <slot></slot>\n`;\n\nexport class ParallaxViewport extends HTMLElement {\n  get backend() {\n    return this.getAttribute(\"backend\");\n  }\n  set backend(value) {\n    this.setAttribute(\"backend\", value);\n  }\n  constructor() {\n    super();\n    if (!this.hasAttribute(\"backend\")) {\n      this.setAttribute(\"backend\", isChrome() ? \"3d\" : \"2d\");\n    }\n    this.attachShadow({ mode: \"open\" });\n    this.shadowRoot.appendChild(template.content.cloneNode(true));\n  }\n}\n\nfunction isChrome() {\n  const userAgent = navigator.userAgent;\n  return (\n    userAgent.indexOf(\"Chrome/\") !== -1 && userAgent.indexOf(\"Edge/\") === -1\n  );\n}\n", "export function createTransform(image, element, viewport, options) {\n  const { align, velocity, backend } = options;\n\n  const minWidth =\n    velocity.x * element.w + Math.abs(1 - velocity.x) * viewport.w;\n  const minHeight =\n    velocity.y * element.h + Math.abs(1 - velocity.y) * viewport.h;\n  let s = Math.max(minWidth / image.w, minHeight / image.h);\n\n  let x = align.x * (minWidth - image.w * s) + 0.5 * (element.w - minWidth);\n  let y = align.y * (minHeight - image.h * s) + 0.5 * (element.h - minHeight);\n  let z = 0;\n\n  const centerX = 0.5 * (viewport.w - element.w);\n  const centerY = 0.5 * (viewport.h - element.h);\n  let v = backend === \"3d\" ? velocity.y : 1;\n  if (v <= 0) v = 1;\n\n  x = (x + (1 - velocity.x) * centerX + (velocity.x - v) * element.x) / v;\n  y = (y + (1 - velocity.y) * centerY + (velocity.y - v) * element.y) / v;\n  z = (v - 1) / v;\n  s = s / v;\n\n  return { x, y, z, s };\n}\n", "import { createTransform } from \"./transform.js\";\n\nconst template = document.createElement(\"template\");\ntemplate.innerHTML = `\n  <style>\n    :host {\n      display: block;\n      position: relative;\n      overflow: hidden;\n      background: none !important;\n      background-image: none !important;\n    }\n    :host([hidden]) {\n      display: none;\n    }\n    #image {\n      position: absolute;\n      transform-origin: 0 0 0;\n      will-change: transform;\n      pointer-events: none;\n    }\n    ::slotted(*) {\n      position: relative;\n    }\n  </style>\n  <img id=\"image\">\n  <slot></slot>\n`;\n\nexport class ParallaxElement extends HTMLElement {\n  static get observedAttributes() {\n    return [\"velocity-x\", \"velocity-y\", \"align-x\", \"align-y\", \"image-src\"];\n  }\n\n  get velocityX() {\n    return parseFloat(this.getAttribute(\"velocity-x\"));\n  }\n  set velocityX(value) {\n    this.setAttribute(\"velocity-x\", value.toString());\n  }\n  get velocityY() {\n    return parseFloat(this.getAttribute(\"velocity-y\"));\n  }\n  set velocityY(value) {\n    this.setAttribute(\"velocity-y\", value.toString());\n  }\n  get alignX() {\n    const str = this.getAttribute(\"align-x\");\n    if (str === \"left\") {\n      return 0;\n    } else if (str === \"center\") {\n      return 0.5;\n    } else if (str === \"right\") {\n      return 1;\n    } else if (str?.endsWith(\"%\")) {\n      return parseFloat(str);\n    } else {\n      return NaN;\n    }\n  }\n  set alignX(value) {\n    this.setAttribute(\"align-x\", `${value * 100}%`);\n  }\n  get alignY() {\n    const str = this.getAttribute(\"align-y\");\n    if (str === \"top\") {\n      return 0;\n    } else if (str === \"center\") {\n      return 0.5;\n    } else if (str === \"bottom\") {\n      return 1;\n    } else if (str?.endsWith(\"%\")) {\n      return parseFloat(str);\n    } else {\n      return NaN;\n    }\n  }\n  set alignY(value) {\n    this.setAttribute(\"align-y\", `${value * 100}%`);\n  }\n  get imageSrc() {\n    return this.getAttribute(\"image-src\");\n  }\n  set imageSrc(value) {\n    this.setAttribute(\"image-src\", value);\n  }\n\n  constructor() {\n    super();\n\n    if (!this.hasAttribute(\"velocity-x\")) {\n      this.setAttribute(\"velocity-x\", \"1\");\n    }\n    if (!this.hasAttribute(\"velocity-y\")) {\n      this.setAttribute(\"velocity-y\", \"0.8\");\n    }\n    if (!this.hasAttribute(\"align-x\")) {\n      this.setAttribute(\"align-x\", \"center\");\n    }\n    if (!this.hasAttribute(\"align-y\")) {\n      this.setAttribute(\"align-y\", \"top\");\n    }\n\n    this.attachShadow({ mode: \"open\" });\n    this.shadowRoot.appendChild(template.content.cloneNode(true));\n    this.image = this.shadowRoot.getElementById(\"image\");\n\n    this.currentTransform = null;\n    this.animationRequestId = null;\n\n    this.image.addEventListener(\"load\", this.updateTransform);\n    window.addEventListener(\"resize\", this.updateTransform);\n\n    this.image.src = this.imageSrc;\n  }\n\n  connectedCallback() {\n    this.viewport = this.closest(\"parallax-viewport\");\n    if (this.viewport != null && this.viewport.backend !== \"3d\") {\n      this.viewport.addEventListener(\"scroll\", this.updateTransform);\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.viewport != null && this.viewport.backend !== \"3d\") {\n      this.viewport.removeEventListener(\"scroll\", this.updateTransform);\n    }\n    this.viewport = null;\n    if (this.animationRequestId != null) {\n      cancelAnimationFrame(this.animationRequestId);\n      this.animationRequestId = null;\n    }\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"image-src\") {\n      this.image.src = this.imageSrc;\n    }\n    this.updateTransform();\n  }\n\n  updateTransform = () => {\n    if (this.viewport == null) return;\n\n    if (this.animationRequestId != null) {\n      cancelAnimationFrame(this.animationRequestId);\n      this.animationRequestId = null;\n    }\n\n    const transform = this.computeTransform();\n\n    if (equals(this.currentTransform, transform)) return;\n\n    this.animationRequestId = requestAnimationFrame(() => {\n      this.animationRequestId = null;\n      this.currentTransform = transform;\n      this.renderTransform(transform);\n    });\n  };\n\n  computeTransform() {\n    const imageRect = {\n      w: this.image.naturalWidth,\n      h: this.image.naturalHeight\n    };\n    const viewportRect = getRect(this.viewport);\n    const elementRect = getRect(this);\n    elementRect.x -= viewportRect.x;\n    elementRect.y -= viewportRect.y;\n    const options = {\n      velocity: { x: this.velocityX, y: this.velocityY },\n      align: { x: this.alignX, y: this.alignY },\n      backend: this.viewport.backend\n    };\n    return createTransform(imageRect, elementRect, viewportRect, options);\n  }\n\n  renderTransform({ x, y, z, s }) {\n    this.image.style.transform = `translate3d(${x}px, ${y}px, ${z}px) scale(${s})`;\n  }\n}\n\nfunction equals(a, b) {\n  if (a == null) return b == null;\n  return a.x === b.x && a.y === b.y && a.z === b.z && a.s === b.s;\n}\n\nfunction getRect(element) {\n  const rect = element.getBoundingClientRect();\n  return {\n    x: rect.left,\n    y: rect.top,\n    w: rect.right - rect.left,\n    h: rect.bottom - rect.top\n  };\n}\n", "import { ParallaxViewport } from \"./parallax-viewport.js\";\nimport { ParallaxElement } from \"./parallax-element.js\";\n\ncustomElements.define(\"parallax-viewport\", ParallaxViewport);\ncustomElements.define(\"parallax-element\", ParallaxElement);\n"],
  "mappings": "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",
  "names": []
}
